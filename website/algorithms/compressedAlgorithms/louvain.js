jLouvain=function(){let e,t,o,n=1e-7,r={},s={};function c(e){let t={};return e.forEach(function(e){t[e]=!0}),Object.keys(t)}function i(e){let t=[];for(let o in e)e.hasOwnProperty(o)&&t.push(e[o]);return t}function a(e,t){let o=e._assoc_mat[t]?Object.keys(e._assoc_mat[t]):[],n=0;return o.forEach(function(o){let r=e._assoc_mat[t][o]||1;t===o&&(r*=2),n+=r}),n}function u(e,t){return void 0===e._assoc_mat[t]?[]:Object.keys(e._assoc_mat[t])}function f(e,t,o){return e._assoc_mat[t]?e._assoc_mat[t][o]:void 0}function g(e){if(null===e||"object"!=typeof e)return e;let t=e.constructor();for(let o in e)t[o]=g(e[o]);return t}function l(e,t,o){t.nodes_to_com={},t.internals={},t.degrees={},t.gdegrees={},t.loops={},t.total_weight=function(e){let t=0;return e.edges.forEach(function(e){t+=e.weight}),t}(e),void 0===o?e.nodes.forEach(function(o,n){t.nodes_to_com[o]=n;let r=a(e,o);if(r<0)throw"Bad graph type, use positive weights!";t.degrees[n]=r,t.gdegrees[o]=r,t.loops[o]=f(e,o,o)||0,t.internals[n]=t.loops[o]}):e.nodes.forEach(function(n){let r=o[n];t.nodes_to_com[n]=r;let s=a(e,n);t.degrees[r]=(t.degrees[r]||0)+s,t.gdegrees[n]=s;let c=0;u(e,n).forEach(function(t){let s=e._assoc_mat[n][t];if(s<=0)throw"Bad graph type, use positive weights";o[t]===r&&(c+=t===n?s:s/2)}),t.internals[r]=(t.internals[r]||0)+c})}function _(e){let t=e.total_weight,o=0;return c(i(e.nodes_to_com)).forEach(function(n){let r=e.internals[n]||0,s=e.degrees[n]||0;0!==t&&(o=o+r/t-Math.pow(s/(2*t),2))}),o}function d(e,t,o){let n={};return u(t,e).forEach(function(r){if(r!==e){let s=t._assoc_mat[e][r]||1,c=o.nodes_to_com[r];n[c]=(n[c]||0)+s}}),n}function h(e,t,o,n){n.nodes_to_com[e]=+t,n.degrees[t]=(n.degrees[t]||0)+(n.gdegrees[e]||0),n.internals[t]=(n.internals[t]||0)+o+(n.loops[e]||0)}function m(e,t,o,n){n.degrees[t]=(n.degrees[t]||0)-(n.gdegrees[e]||0),n.internals[t]=(n.internals[t]||0)-o-(n.loops[e]||0),n.nodes_to_com[e]=-1}function p(e){let t=0,o=g(e),n={};return Object.keys(e).forEach(function(r){let s=e[r],c=void 0===n[s]?-1:n[s];-1===c&&(n[s]=t,c=t,t+=1),o[r]=c}),o}function w(e,t){let o=!0,r=_(t),s=r;for(;o&&(r=s,o=!1,e.nodes.forEach(function(n){let r=t.nodes_to_com[n],s=(t.gdegrees[n]||0)/(2*t.total_weight),c=d(n,e,t);m(n,r,c[r]||0,t);let i=r,a=0;Object.keys(c).forEach(function(e){let o=c[e]-(t.degrees[e]||0)*s;o>a&&(a=o,i=e)}),h(n,i,c[i]||0,t),i!==r&&(o=!0)}),!((s=_(t))-r<n)););}function E(e,t){let o,n,r={nodes:[],edges:[],_assoc_mat:{}},a=i(e);return r.nodes=r.nodes.concat(c(a)),t.edges.forEach(function(t){n=t.weight||1;let c=e[t.source],i=e[t.target];o=f(r,c,i)||0,function(e,t){!function(e,t){e._assoc_mat[t.source]=e._assoc_mat[t.source]||{},e._assoc_mat[t.source][t.target]=t.weight,e._assoc_mat[t.target]=e._assoc_mat[t.target]||{},e._assoc_mat[t.target][t.source]=t.weight}(e,t),s[t.source+"_"+t.target]?e.edges[s[t.source+"_"+t.target]].weight=t.weight:(e.edges.push(t),s[t.source+"_"+t.target]=e.edges.length-1)}(r,{source:c,target:i,weight:o+n})}),s={},r}let y=function(){let e=function(e,t){if(0===e.edges.length){let t={};return e.nodes.forEach(function(e){t[e]=e}),t}let o,s={};l(r,s,t);let c=[];w(r,s);let i=_(s),a=p(s.nodes_to_com);c.push(a),o=i;let u=E(a,r);for(l(u,s);w(u,s),!((i=_(s))-o<n);)a=p(s.nodes_to_com),c.push(a),o=i,l(u=E(a,u),s);return c}(r,o);return function(e,t){let o=g(e[0]);for(let n=1;n<t+1;n++)Object.keys(o).forEach(function(t){o[t]=e[n][t]});return o}(e,e.length-1)};return y.nodes=function(t){return t.length>0&&(e=t),y},y.edges=function(o){if(void 0===e)throw"Please provide the graph nodes first!";if(o.length>0){t=o;let n=function(e){let t={};return e.forEach(function(e){t[e.source]=t[e.source]||{},t[e.source][e.target]=e.weight,t[e.target]=t[e.target]||{},t[e.target][e.source]=e.weight}),t}(o);r={nodes:e,edges:t,_assoc_mat:n}}return y},y.partition_init=function(e){return e.length>0&&(o=e),y},y};